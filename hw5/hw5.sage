###### Exercise 1
print "-"*5 + " EXERCISE 1 " + "-"*5
p1 =  6277101735386680763835789423207666416083908700390324961279
a1 =  6277101735386680763835789423207666416083908700390324961276
b1 =  2455155546008943817740293915197451784769108058161191238065
n1 =  6277101735386680763835789423176059013767194773182842284081
P1 =  (602046282375688656758213480587526111916698976636884684818, 174050332293622031404857552280219410364023488927386650641)
G1 =  (2207999985949147855774131927931521546316920247890707501762, 3205787392243260402097142399074377125702612955340482579358)
m11 =  "I'm a hardcore fan of Star Wars and therefore I'm cool. Also, management."
m12 =  "I'm a hardcore fan of Teletubies and therefore my taste is questionable. Also, prevailed."
C11 =  (3030738238914604904627032123318785615323952811371469684765, 222364424577122292778483595070824372657209361848797394869)

'''
C = H(m)*P1 + R
So we can construct R in the following way:
R = C - H(m)*P1
'''

def hash(m):
    return int(mod(int(hashlib.sha256(m12).hexdigest(), 16), n1))

import hashlib

F = GF(p1)
E = EllipticCurve(F, [a1, b1])

R12 = E(C11[0], C11[1]) + hash(m12)*E(P1[0], -P1[1])

print "Q1="
print R12.xy()

###### Exercise 2
print "-"*5 + " EXERCISE 2 " + "-"*5
IV2 =  "a6e89eb859a3e53e34f2b99337c870a7"
H2 =  "7322ec256cd2292e5867fd3558556d64"
P2 =  "The password is "
S2 =  ". Under no circumstances can you reveal it to anyone!"

from Crypto.Util import strxor
from Crypto.Cipher import AES

import binascii

#AES encryption of message <m> with ECB mode under key <key>
def aes_encrypt(message, key):
    obj = AES.new(key, AES.MODE_ECB,'')
    return obj.encrypt(message)

#AES decryption of message <m> with ECB mode under key <key>
def aes_decrypt(message, key):
    obj = AES.new(key, AES.MODE_ECB,'')
    return obj.decrypt(message)

def xor(a,b):
	return '{:032x}'.format(int(a,16) ^^ int(b,16))

def getBlocks(s, l):
    output = []
    for i in range(0, len(s), l):
        output.append(s[i:l+i])
    return output

key = binascii.a2b_hex('0'*32)
length = 12 + len(P2) + len(S2)

padding = '1' + '0' * int(mod(120 - (length * 8), 128)) + '{:07b}'.format(length)

e = aes_encrypt(binascii.a2b_hex(xor(binascii.b2a_hex(P2), IV2)), key)
v = binascii.b2a_hex(e)

end = binascii.b2a_hex(S2) + '{:0x}'.format(int(padding, 2))
end = end[int(mod(len(end), 32)):]
end = getBlocks(end, 32)

tmp = H2
for x in reversed(end):
    d = aes_decrypt(binascii.a2b_hex(tmp), key)
    tmp = xor(binascii.b2a_hex(d), x)

d = aes_decrypt(binascii.a2b_hex(tmp), key)
tmp = binascii.b2a_hex(d)

print "Q2="
print binascii.a2b_hex(xor(tmp, v)[0:24])

###### Exercise 3
print "-"*5 + " EXERCISE 3 " + "-"*5
p3 =  143698230131740507655846256288797223799987772629973671858639141670675037171325797044454744165157619675129842868333403053029047214293195790362644789612094712102549316384313140508554590228690046703754319514785566290950044949198302530626266423179199949018851217644419413531421671453810313498515326492269434966999
g3 =  17
X3 =  90087037496154623272962965256634520674416283069794451561514199773681864062234975526501880862274710576156356264318954008510064704493598847712928190887410882621674247292660421568079253844668881599198379732553306402372058332923078194614652896272678281291171531684061414720136886068666423595013490222372113541994
Y3 =  70872393963840516706881213696616523017389769120776110104973009431812667797028040354642896939993300973463506541294698574052354636812004049737511545942651936161016238207309422167157287373481163512001421537529399942140813444056979565524212628340363872381634085761734499346605587912264102271691740505085247332983
x3 =  46804840914700365969342702316884488175990012811666535580866002753773456647184535237788105602022602916943284626605313941469164019740364411715796211607417914441621616530882526844802715360809718291155769016093935757856237109355665760987097831359425486251368024513327523129388737822357820814400111004829520950579
C31 = "df8a438e0e73a2c1b18be22e15fc2ae1d2613ae83af8906707f067c5c901c672c38c14041d892acc8a7b44779cc9cd1dffef8102cb4e21743bfb2b8d4ad0bd86"
C32 = "41a937845dd4642e82cb9192c52e78529b9ab5bfd8a76271dcaf379274c00ddd117eae086fb9de63b3b363d815d4e9c8916e2fda602ec4c45a521f8e0da4e281"
R31 = "fd245d2c99767cbf1b462c214b748c13"

L3 = '{:0256x}'.format(int('{:01024b}'.format(int(pow(Y3, x3, p3))), 2))
L3 = binascii.a2b_hex(L3)
J3 = hashlib.sha256(L3).hexdigest()
K3 = J3[0:32]

def binary_xor(a,b):
    return '{0:0128b}'.format(int(a,2) ^^ int(b,2))

def Lshift(s):
    out=''

    for i in xrange(15):
        out = out +  chr(   ( (ord(s[i])<<1) & 0xff ) | ( (ord(s[i+1]) & 0x80)>>7 )   )
        out= out + chr(   (ord(s[15])<<1)&0xff   )

    return out

def Rshift(s):
    out=''
    for i in xrange(15,0,-1):
        out = chr(   (ord(s[i])>>1) | ( (ord(s[i-1]) & 0x01)<<7 )   )  + out
        out=  chr(   (ord(s[0])>>1)   )  + out
    return out

def mult_bin_by_x(binary):
    if binary[0] == '0':
        return binary[1:]+'0'
    else:
        shifted = binary[1:]+'0'
        return binary_xor(shifted, '0'*120+'10000111')

def mult_bin_by_inv_x(binary):
    if binary[-1] == '0':
        return '0' + binary[:-1]
    else:
        shifted = '0' + binary[:-1]
        return binary_xor(shifted, '1'+'0'*120+'1000011')

def ntz(i):
    binary = list('{:0b}'.format(i))
    output = 0
    while (binary[-1] == '0'):
        output += 1
        binary[-1] = binary[-2]
    return output


m_max = 1
if len(C31) > 32:
    m_max = int(math.ceil(len(C31)/32))

e = aes_encrypt(binascii.unhexlify('0' * 32), binascii.unhexlify(K3))
L0 = '{:0128b}'.format(int(binascii.b2a_hex(e), 16))
L = []
L.append(L0)

Ln = mult_bin_by_inv_x(L0)
for x in range(0, 31):
    L.append(mult_bin_by_x(L[-1]))

def PMAC(K, hex):
    delta = '0' * 128
    sigma = '0' * 128

    l = len(hex) * 4
    M = hex
    hex_length = len(M)

    M = '{:0b}'.format(int(M, 16))
    M = getBlocks('0' * ((hex_length * 4) - len(M)) + M, 128)

    for i in range(1, len(M)):
        delta = binary_xor(delta, L[ntz(i)])
        xi = binary_xor(M[i-1], delta)
        e = aes_encrypt(binascii.unhexlify('{:032x}'.format(int(xi,2))), binascii.unhexlify(K))
        yi = '{:0128b}'.format(int(binascii.hexlify(e), 16))
        sigma = binary_xor(sigma, yi)

    sigma = binary_xor(sigma, M[len(M)-1])
    last_x = binary_xor(sigma, Ln)
    e = aes_encrypt(binascii.unhexlify('{:032x}'.format(int(last_x, 2))), binascii.unhexlify(K))

    return binascii.hexlify(e)

print "Q3="
if PMAC(K3,C31) == R31:
    print PMAC(K3,C32)
else:
    print "Error"


###### Exercise 4
print "-"*5 + " EXERCISE 4 " + "-"*5
M4= "send 98743 chf to 227358"
Y4= [['25e0eb7927341fc8ec089ea4d3e9e412', '427a96a18739c6e1ec5485ac88071860', '9d683f52a56fd3c65d3bd12fa4eddd29', '8d37fbfb011f8696057ced5b74a1658d', '9c644dbafcae04a7f9df6768fe4bbd86', '7e2f340ae9478ccf81857b35f35961d1', '40361ad2c8c034200e07ddf530b46ef4', 'b3edbedc9a876407f95c0b0897d5c342', '412e2cea4fc9cedd0609ca65258d014e', 'd68d080640d3aeaa21ed226ec89060ef', 'f96b81be402c5e287d7ef37a66ab97dd', '3cf0ccf61eaf34b5de514906aa520e23', 'e0516eda12a52227c6b67ee3c0dde573', 'a24ef1c090f2566fa7fa4f213fd12235', 'e4e8290d396e21ae7f96a8b4ae168afb', '167fad908146e4f8f0105308bbb5842b', 'a430dc846c55f811655e792ad52ac61f', 'c9db8df2078ec99bdfaf521da611f937', '32840c7699740cf7b8048778a6d9c380', '67ae16bb849a898ef9424947c76faf74', 'e5d181241b59d5d5b3777274c5750e79', '2213ac5a78cb01b85f1da0cc791c6983', 'd96b5b0c4aa0b63b309927fa03ef86d5', '350c09600467d4a4124ff4d66f14c328', '4a1ad739a778bc5b5ccea7aedd44f440', 'ce84e4cdedd958a4570be5d02ac266e6', '2d610f6efaca0bc14d389a652076c54d', '880ecaf3a35da0b4b6cb22bc75990ae5', 'cb8468b477e103a245e44509ca56ba8f', 'ef52747cdbd580edf78ebdd47bf2844e', '904e7825a38c9f95616407fafd25a424', '7d5057b7c50c63a445e965a91de389bf', '0a5ea6ab3f46ec45d46fe6391e8c3fb0', 'caaded89b36406c8aba76ced595b2970', 'a8de2a038a1fa27d2654748be8a6e0f6', '9177ce23982024af66c980bc50329a54', '9d3a0e1c93867e89437ef4028bae0f78'], ['1cd16be76281a78e97ab8a809d3a097b', '6e2d1b63c4965401e72ef53a007d40de', 'ec0bfc512f31811d8e9ad01bb81b4163', '22540523570533661419aa3eb72d12ac', '5eceb430e1445de910c88e2595d04c22', 'a4acdb85a7ec6b475dd480377fb9268d', '31b90e3b2bc8b762506b968c332c02f7', '013e7df7ae3202d389efd15984b3e854', 'f8d70cb43b945ba5ca6a451ffb1d9661', '86b1849acc5f554a97850fb79055b9a6', '83e79c392d33e6309de7ce414a8fbfc3', '908674ac2642aa50321ab8537f673137', '5aeee691e7a1ad6000846e8e31584386', 'f73df4b169cbb8c1ad8115eeb9c79229', 'eceeb28220645ff3da0d33015a48cadc', '14b1579a581b0147dcfba730632d9e40', 'bf62170dd348c89f3129e9962a49d8ed', 'bed73f83cb1524a0616df649926bd333', '5c4465b6c3f8d3181ceffbd705d94e17', 'bf0fcaabdec3cebe0dfb9826497feb81', '0c3984732f0c18c99dcbc5a946bbcd38', '5d043f331d1a43a13803045f93e17982', '3fc16c376ef5e146a758974cd2731096', '3f3a7e1aa6f5228a351eaa1654ff5df9', '234e842f9a1171df0eb1798ee1663425', '843c71923d9d78907e01b393dae41b35', '1c762cc9981e384113507e56fbad11fd', '3d836f39210b4a21f2ebd0645e90889c', 'b05040b55989982c8a1eb4384af70a2f', '6ca187cb296f4356aa3e28a058795fc1', 'df128a954c8794e041fe2cf56462aeda', '02cda4e930de0ac0950b47f3cd8a661e', '0222efc2930039fb3a0c778cc3e2402b', 'a0f490944d4e21f28f8d7098c83b6cc8', 'f15f81b1362da0e67d529414b59b6c30', 'f27fcd820b6eb0c71865f5c6f96e2b41', '5c2516930520fba3c734c77b108882b2'], ['943afeeba2c844de90b512c464472034', '6b0686fb6190bddbb859502cb25a6855', '2662f52cbf3200d486f08687e03c51a3', '657d19a44ff94270a30b78607b5b5f11', 'c2b08faf11036a15491f81b0dfcef8ad', '350b54101d3afcbbfaddc76564501c6e', '530920d0526082d06f9a5b9bb0fce838', 'c363a6b50c0e1c6af649220e3e501e1e', '064023f7fbdb6038da459e29e93f99b7', '1e1ded0d7473c8ccdec78f4248efa65d', '9f29c81ed405ab9356dd0ba901f84af2', '49d0be100b974d9fef99e677490f414e', '5c8ae68ce239f879052626311dfabe62', '4ea5b1f39fbc3459b0878f2c27aaf439', '3b4a565e5c53c3bdb73fc4c9b7686325', '83238e399a33195b5a5ad1fd43dd4afe', '2eb94963cf5e7aff5e573ffa5986be7c', '4c577966e8213fe16256f66ba5755c83', 'b740466954dd5307f1178f8228f22aa2', '9781740de211b4aa3f6fda5ca896ff3d', 'aac189e2f0ae4ac799475e54db36d3e7', 'ccfedaceafd4bc7ac990c2bcba3f384f', 'bb8f33d4166a54c085e4538496660a87', '6e7a804b30e2a057a28013b080b8b407', '34b53a68cbd1e0394df285a70bca7883', '6e3f862a43895eca950cc42e1c97e795', 'e7af8ff5456f71ad9076c58efedbc56c', '9ddf83b564beba850ff053a8d42051e0', '12062417446a198e67119300d2e51662', '145c01d6c191dcd4822bbfd2af1d7147', '1fd853f143cbeaceb83bbaf32fdc60b2', '0ad072d5f34291734c8b62a90c1c5553', '30efa916715b964844a4e3dc7fccf98b', '88758f6d331fa0e1a29d384b30bc9743', '2c0203a210454489a3be125664356808', '1fd2144d400a59de7f5a6c64a59d6ec7', 'cbfa0f2b46d8b8616610ead165644d96'], ['f20c170294302ea250ba96b6ce62aed0', '9f388e2aeba751a0f9b6208ed00d5ce6', '958c43d673896c5a73a390330fa58856', '50a1c01370803f59f6af13c79c8fe2a2', 'e9e828f9967bd4331f7f0221c2c0222f', '12d721a16a4385c7e481d7238a66c81d', 'd10014d3d58beb942f2e1fffaa306d36', 'da3f47ed222a70987ed8c6c639997c51', 'ad28726677f8005cd706213956402019', 'a4d81e0c91d158b117ed1b2d5ba79d51', 'b79b79902f4034364a3080f5a51c8a9c', 'ee645ed9dab347dab4da1142e5bd77a0', '020e3b636aa042fe7da7ef653955e933', '121b8256b16782002fe7e84a6dd0f304', '81f1ee80311a8bd0a27d5dcccf18627f', 'beb3e6cadc9aa2a3be70d24318505ccb', 'd5b26702b99ac35c106b290e81dc71de', 'd133a82a777d51f0e147df7d0b24fcff', 'a5061970ed8408c6bf35e683a620bfed', 'a1fb009d4bb92c0372e7618a9119443f', 'c2b8721320a6ddf29d14edf53b0f4414', 'c4f726e1a5b2e0ab6617251c5222db6e', '197a80c70fb89f9106d1bce390537e75', 'da6eaaa5759a616bda4180f8bfcd5ce2', 'd19b54cd7e3112cf5076ea991ee4b2de', '6a7e5182d1fa5eb067fa5acdd10223ca', '74c1185d343acabb0cee776f51311c5a', 'd23e88be9db96af1c22c2631c48d40f7', '4fa7a58442a4c96ece929b649837a8db', 'fcaeb95aab149f2085cabf09de244f0a', '7f1ee90ca6901db98cd58eb91b3428af', 'acf1a7b0143c0e5986de84c02b38c04c', '894e7cb734ce001782df01fe93c3d2c4', '57a8bb3634cb29d934b75129c7fc69b3', '7633e2b0754ae7de4c67caef00310f44', '9094296832d7ef75d7eaac2e4003e57f', '6f11563ff3b330a51eec9c16ee612bde'], ['adf70c36830e0ab8ebfab8e491d56920', 'dca26a4e1d7d56f1dd63848b1383727a', 'dd803a89263a1c5487b77c126fec3cf3', 'f738cd3b45003f99f3c09f5e0a68e31f', '42aae843f708ed7283c7ba5821d6eaff', '76f537cb47b31bf5f36db891179adee6', 'a9df22b7ea54f1199f61295e6ccd376b', 'f2adbd2e14d4555878fd5e7494378b25', '78d405d75784d02f9bc1eff8e285aa36', '50795ae942b4c70800e3f45fb5d0def0', '7204e6a08e6ea56b2104ab9ab0c705e4', 'ff95d9e83500f6c77923cc19a9d25e94', '4922b6e90e098d2765e151d8552f66a2', '5d5c4050fcfece42be68abeea3fb5876', '95cce3e49eaec4527473c9fef8838d5a', 'd599cde7275de5ef80391adbe1036053', '765235cfc246731a985841ad781db06f', '269c538e484299b363ef819b8fb209a0', '0d97c32b200d6bd6905ea786bfdae68a', 'd02b2310538a7bed744106d0497b424f', '45b618a5775ae201b9ecd10342cc0bd6', '36912bef8b86c5c6545d13a5479a3b44', '1c234b077dd5b2e4e9a9f8ac4b5cb502', 'eb390a88eadd48a84bd1b947e7f652a3', '68dabdce2e0e1e594f8521a47bc0959b', 'a8f4a5c580541139dc7069424041ad5b', '67fccf0ec1cd46b5f57279f085e8a492', 'b3b6251f37395845ac19b0ee17d666e0', '311e7a31e27dbbdad7bd6bf15d643a1b', 'f5df76554ff96cf3b4e6bf46feb286b2', '294e901262f8f5aa8b5fb12d0d017069', 'e0d6a26127430ac5e97e4e5a5270fd12', 'f8683e2211f7162a28a5ae4d5e4da2ad', '2143dce6b07ababcf13eb603b195f471', 'dbf0cf90ea5f03c66fb771ab218ae13a', '9b21b9a9cfd37912c3336218d3b12fc3', '72cc4ce3fa00f1f641feb78334668bca'], ['03bfe44e38453ecfb373d7c17a744db0', '574c393e3583ebbbafc807a3a18e6cd5', '39db51b79a36cd2c804366a9eaf6064c', 'fb8da672f553a538743b8ffead3802f8', '69f13ba456f32650b9a72a8ea26d5244', 'b45cd846c268a54d8e8d66d56a2c12f3', '5e91fe29ed7ba56c8b2d526bd54d6a3f', 'c97fffb0d4d0f1b210db17981ebb7ec3', 'e2bb3bdc65ad15665bb95bbb398e2266', '00c4efe53501435695d778b70045a195', '0d09889845c35167ca5a54fcf2fc7ec1', '01399b8cfedc5f4abcc2a20440424784', 'eb9cd27659a7033e8e0bc256dd6da3aa', '13cf61ce89f997f4a10cf0637a8602db', '40c77d1773d303c85835aadb58424077', '4f40b809e964fb11d6e00633269f1646', '3a73189643f8ba513aa56585850d39bc', '463444d12cec00de9804c58575ddba98', 'cb483fb1ee66673f069d168f9757d0ea', '460a2fcb13cd7cb860451fb42766f22f', '29768de82cd6f3ba52341d1eb2310fd8', 'ed3bce911e2b94a6685ed93669abbf50', '251654e9e1c9e6319af28bfdc4240ea3', 'f8f6b790e5c1fc4c57c32b9553dc42ee', 'e6e9181b0f879e1fe66619e6902cda31', 'da10be2bbbc50ecede6f027da508ea4c', '9ed77ae6978263259b283cb34b44228a', '58e35127b2224b84d670b90e684f28bf', '1076daf0662334f9f88f8c3a13a7da37', '260284508f30090a29dab1637fb38b61', '70fd2a579abbe8ecf70f2d12d8613a1d', '05ddd98a5953229d0518e7f743bcbc12', 'd779c4783f0c54f57b96100e3ac4364c', 'f0e0647a3f7f95fefed1c1b8bccb2834', 'a2ac78148a9f0d0c6f678b7e5d9e5ee2', '3e4dd4abf84b011845aeab417c62077b', '7c2ae4e1689e072e4ea119cb3501bed9'], ['71caf5286085ce749fe8c020e310aab5', '021b1c5621ec5ef93eef043e4fdd0731', '262c047d34312050b8307b3165a89d2b', '9926d70a3f04d1f0000877ff67316d4f', 'cacfe7fce108b5da46dd046d85a2a783', 'f43a724df1ff74d819e3c271875dea34', '30a87ca10251394f632bbfe634d94aad', 'f8636dd34003d8882dc964e7d5a41ab9', '3a83e30ae282f9433a0a118f58de5443', '8f176f3b1b46297ff8538ba213fad52b', 'd6c2da0e0dbde44765a3c9e03db02eb1', '9113ba05527c0786a2159f88794512c0', '1c2b46ebb48eda559c0f8a42895e6f59', '96d6af779c1d51440dd678aedb96859f', 'e36a38d831c9aafc3039e8ebce05e900', 'fb1c988615b0d351168c0f1a94ab22e7', '82997e8a0d9b45abe8d0197708e02c6d', '00119874204ad73b359246062869b1e8', 'ea957f8ee35cee02f4160856680d9765', 'eedfb8c2ea94cc04cf8cf3b8266bf2d5', '5ed9c35627819245a5c1bd26a5033530', '1c68250844556aa202dc50aa83c0745d', '0f51e834fa20dd8963dd166c28348c06', 'f7083ba8d4b2f20e4676acbb55a16ea1', '109c4e237c64d67301e2e38c39cd0321', 'f31b218ad0ad6985391b34661c8ecf6d', '33eaf38b443a00be204a92cf2c6c54ca', 'b9660aae36fcb0fc60123a3a58ace058', '075bd2881ed581269cd5f61efa6cd8bf', 'a047543b95448a4d68a342cb7ff4c9d4', 'b75173017f8dc130b0ddaba0e57689be', '7b2cc708c8cb77aad1203e99e7a77982', 'ac8513cf896f5d7cec2d64dabca52f0b', 'ffa750031ef7e87480a76c7062662117', '4485817e41c5985a484611aa02a89c5d', '45d685f48e87e8c0a01a64d2ef5db3c7', 'cfb2e87de7ec844925f49800e11e9960'], ['d9fe6297ea8d1f135ba66dc55ff5705b', 'ae217ec1eb61cc18b10809761f2fef23', 'b472eaf4e4b5a759c7510cf62fc30239', 'abe43e0e584ed00b1fa1acd283074c22', 'f462636e8acb76dfd487ef48f9dfd03f', '5d2eac37a744581126e79ec1369c849c', '96004ea6c16bd07bfc0455417ba90a8d', '085c94849c853e22eebdab2100a166ca', 'dbccbaa6557532019610c39ff641f372', '75eef778e5b8fd57296cee7706a13a67', '5cef485d926eb5f408712af74ba300bf', '00deec633d813342315a4c7bfb9605a8', '7517b088ee0e4a1a14c272ddcdf66a88', '3306764a58572a84b9318f422e1c75ff', '95c4852c7b5a509cb48cb0b12bfd7fac', '44b59df9dee28526934110a8e4e71ece', '10a7f9b3c1ae341a07989d395a24d8d8', '06eb8c95cf506fb43df7b3efb31eddc3', 'b259f7b85a51fb4abf029cb74332e866', '80460366259bf6771debc9ff7678f760', '62c6d12b70be2eb85fd55b78f7d4622f', '664a3d931421c485989e0b9fc667d041', 'bbc5ccf04befc6748559ba9beb8269b5', '38386a07cbfa73faee407404f7d3c98a', '7295e3fb636799404cc20880754ed5a3', '9b37ae28695b39c0ebb658b7a186e6c9', '8a18b924a53a6dba32a070a957e6a124', 'f44f30f48ada7a12d711e83256fede78', '5d95c9a68879e5e8582597a57b638104', '105ecaa2fb9ca98d72f1c346fb49dcb3', '57328fe4b90ea074e41cd48abcd095f3', '14a4a0e14ba5d73bfbb31a397d134141', '141f8fd3ee282f6014c459aa0043a9b1', 'fe6b3e2427c9daca746196f707d09ae4', '9ca6435efed32ba5d76e816b1e52e181', '801a15a7a947d77e3b4e5a5f23fe2c17', '4f0de789b6e78cf93363f3c50cbefdeb'], ['6a227f3e14451bdfc3cac2c59fd52f4f', '37342cc15ee25d51da7d58188af53b09', '088e126097dd2a6cdd9ecb020471f1ca', 'e3b80c801b835be6a88d6120e03b9a71', 'ac257a683482f3735e223e27503c130c', '7bdda927d97fcf2f900c047af6c926c2', 'ade1e4015c41acfbe0a52fda757f76e6', 'ca2ef1f6957de03f00c7c9e1cef92390', '5e76f9bcea11b027e6d5885902c83c33', '0483a6defb1c2e76c0f1c0ba18f7c821', 'eb53f3ede8aafa7388e36922dca3a7d3', '2b95c58ff81df78f83c88e038c86e551', 'b637edeb1a718259d86938925d50a398', 'bb98a4fada7c4c510ee5c249a68a4e67', '2124aaab52160729a1fba5198cf79a2e', '44b2680cb199346df7d70945d3353b0a', 'c279190e0ff4122d51efbcc703e4e52d', '85bd8ac489f32ef001de91c03c684dba', '07e0480bf3658ab542ee8da8a0578902', 'f0107305fd52aef3b26ec4e74ee5425b', '1390bec5e33449b3413a58bc7981afca', 'bd2526ea8434b5fff5d28e52a3fccc7a', '13ff51866ce3439a224c680bcdcc24f3', '6bded3d8f60da14cd34e6c5e8e86eba5', '820c0823604636640eb7bc6854c49c17', '94f7ff8e6bf515ca5bf5784fb5a19b5b', 'dca02796551a1dbf1e9b3eccd0664988', '91857ad2eb39ff2d3ceeaad2bb9e3773', 'b498794e2b3684776839acb0a5bf5d5d', '7968ffc1418a8e1941df005c8f6f374e', 'af08d5d10aec1614f5304f76998b6242', '243977e0f477931d7c14953503e0c8ff', '35a14429e80cfaa0ec57fd8c573b0b3e', 'cfd2db65e4712d9eb1269a8a9070da74', '7b9875a522ae0460b1592670cc09639a', '53a0e97f9118e44406b1e2ab7fdaa3b7', '525ac1caf3921589a262d4c203befb6a'], ['41b604dd9e68201d69aaec9073198f8f', '901cc1e544243d832d7800f96d55b390', '701a5bf9c9f6862dc90c49ddb619fc5a', '1c033ecf91f54cfed2cb5f3e02dd6650', 'fc0eb0802041043b49ce37cb894eb715', '440a1839ab210af7675dbd22f5d63065', '7a96af46f501979a3b35986e13820471', '41ad0a4408179252fc998e336c812817', '1f8d74f6fadfa17b3a206984372efa78', 'a7068b54c9ada0b8df140c4452f9a194', '287dfd8aabc796ac5034f3b52ab3f277', 'ada15a42de4d9c5e5b26a1432115c234', '6b1cce7a87cb26a8e4d144016d8ebf88', 'c762a91a86db3a6d16935822fbd143d4', 'd4db795705daeb78601c3574103c67b0', '47e177dfd6668f77a814c7473605d3c3', '749bc0eeae4e04b2a727ca154b7d50d2', 'c6cfae25c738aa912c1633724ee5daef', 'dc6afa34c197179ef38e816950617ede', 'bd6b70419d29b8dc20fb7fb1fc3c5b93', '052a07e4fb40f7454b57aa5b88e38d48', 'ce641cd8ffa71e76231381a8e30338da', 'dedcac94c96d56aff2c2560f5ab720a4', 'e6eb657da1198b8b6b4f0a02263cb270', '33e5599d88996b30986474d64c82a23c', '5406b120ef041fccca3070ca3d660312', 'd4a57345bcaab2741626e8fe70f51857', '1886e509473b85c5c0c0962807dfed65', '9c504cb03dd917fb8071b7a7a4dff3c3', '95e2174d3a7d94d4dfb8d980f3cb13c6', '95fa2aa051a3c959c5d75c155a951d98', '97e0209cf8efdc15c378c89fdfd0b481', '014b378b1d3972578a1400759ace7bcc', '9b272ca8b8406e975e6844fb5859177a', '29d74f64bbe0e7a442d872a71e7717e1', 'a2799ee7a1d52c6a2e5d8faacd3c84c7', '76b0df7f433952a93ab1bcaf438c53c2'], ['bc33b79a48c91db20135eb8978c7c86b', '1a593214dc22499c2843bd7d4b08e0d0', '78c496ccd73b6b645b86e93c6a4a98ae', 'e4d7a745a55f6961b057354b31768aec', '87ac86ba521777c2f99db957fbe4f10b', '74609dbfd84d40e7376b7adcddafae54', '3727fde4c63f678a1a475dba4c991854', '14b5426feb2c28ba525d3713cba5f8d0', 'eb6ca91540cef976cd3d9c96e2bddd7b', 'd59e485835b56ab809bf57e7c7c5dd9b', '5c9febfd0fae6047c94a9ec915b4721d', 'ac04041e44c7215cbb14d6e31624be5a', 'df9e8ca1707ed14ddcf82b2340ce5bad', '070f4813e193ffb597e8e6f5d22cc6c6', 'c10ab0ff524fe31388f3d667284d2096', 'a05b3232ba97fa39fd8c045bc319a740', 'bc024485005f3a8fc30da4c00b1d8653', 'aa631755828eae866071a1384f246818', 'e26c839606be35d54f055aa0a415832f', 'cb1dfaf8dbaf49e36a1e203db027af1b', '93b898870a4701f296da76feef88869b', '681c6fd59f9ec11d4de16f636838f053', '2e541629d846144c87063bdb25a7ce2e', 'e55582447fa9d54b4a56fd92cf9a4b4f', '7e29ac2ae9df832d7cef0007c1280165', 'f6c8e814590d6e8b96953d54b1dfaa3b', '7b821dd4a034ff5feac501325d0befc5', 'be02a46151069a6bfd01873f3e057b68', 'eb827a6929a91f22f2415ca790e5a994', 'ef1dd75461e3d1bce6c61a0a6493cb8d', '267d0c3d030fb66b3c32040501805f6e', '680358a942664e9887bba43bcc99da30', '9b2f19e17b3fc2898728ec1676fdbb65', '7c566c4be7d0690a48e397e4315c0f2e', '3c89d20fc3b076abd58124723781a9c8', '1b98cd542b1f13f7890eb83ad7212f35', '29e3e03a35983e46846de76bc084290c'], ['83e79c392d33e6309de7ce414a8fbfc3', '908674ac2642aa50321ab8537f673137', '5aeee691e7a1ad6000846e8e31584386', 'f73df4b169cbb8c1ad8115eeb9c79229', 'eceeb28220645ff3da0d33015a48cadc', '14b1579a581b0147dcfba730632d9e40', 'bf62170dd348c89f3129e9962a49d8ed', 'bed73f83cb1524a0616df649926bd333', '5c4465b6c3f8d3181ceffbd705d94e17', 'bf0fcaabdec3cebe0dfb9826497feb81', 'dedd12bf5c58df8315e7c52048209a24', 'c9930b020f4e3ca58cc30aecb2f6cbfc', '7ad1821ae12d7db7fb9a46d165896836', '74687f480e0a19511fe01f94d3fe6ef9', '7d3a7d369482016e9a3218ba913352f4', '39bc121c502c228c48d573efbbc4b75d', '7cb8d85d35619cbef2c8f34e13780a8e', '4236df4cb1b8555b76d9d68606d2036f', '2bb84ce67d9923dd5f4cedb4d948b1e3', 'b66aec9591475089f3ecf57de2821b7d', '632d55eeff097e169bb8f96a9e310805', '6aad5a7ea134ee0a27e2d0fdb6d87f6e', '0dbf10970c94f577513f049eb97b6317', '0a1fd066e96028310686c0b4f2762cd8', 'be680fdbd23eb94909b444336667d2a6', 'dd1cdb98efefb3658bf652dc59e2247d', '8f3e31ccf79a82857255abc114e18e8e', 'f07afb6cd02cedff0136a61dc8c3ac13', '6578351b47ee034537f22eb8eb004c46', '83f0bfde3e516163c248ed81b91cd9d6', '58b7cdcc9cfab0ac4913b7b32292866c', '2b1128a07c0529a9fc491835e8138f7b', '102cc7e95ba6ea864a53a9c607cedb31', 'e01300ed579eaace72da3c36a1246000', '86f94074e845227b4370fdd88b19e864', '7f8f1dd44246a6013fbabe734bb9f9be', 'ef358e7716cfadb39784c43071e7d31e'], ['0c3984732f0c18c99dcbc5a946bbcd38', '5d043f331d1a43a13803045f93e17982', '3fc16c376ef5e146a758974cd2731096', '3f3a7e1aa6f5228a351eaa1654ff5df9', '234e842f9a1171df0eb1798ee1663425', '843c71923d9d78907e01b393dae41b35', '1c762cc9981e384113507e56fbad11fd', '3d836f39210b4a21f2ebd0645e90889c', 'b05040b55989982c8a1eb4384af70a2f', '6ca187cb296f4356aa3e28a058795fc1', '757e7dcb36631b3999c52d521f3d5a92', 'c158f410037ce5aa2fd30bfbd9ee4b6e', 'aa5ab2e5ca76d2b7d6d78427988b2a3c', '6a0a66e14fab97dbb59fcae18928fed4', 'fc7d09783abe532ec02385f9183357e7', '6ad030df41248fe42aa55827eff230c7', 'a271dbe2db934b0efe7c683834c924e5', '8df9b7ee8c0951afa18d98184d61b858', '35cfa503f8261024126c8a92016ecaed', '0912948b328ce04343d9d641ba3e9f45', 'a95046d99a5668c50e6cb7748d8b17cc', '74671f8a34a5e28795fe4e856b8ac9e1', '2d951fe809a6c82c9b0b7d7a54e7a5e6', '5d58094b9cd53585efeac3dd81510abc', '8e683d6f1f803e3718ace90d3ce66594', '233080b0dcb9fbe0860f4bd8b6c78a94', '7e74e6770a0c9b448b4a8bb5941dd690', 'c9e1d0874639f9604c0fec3002d3d57c', '8349858486e2bc494fe29f9d01c0bbb3', 'f76d7485da528b9e785795cb1f0c99ce', 'c1428f7670e705625e1904d132a3c24a', '9af0e31c9bc7111e463bb82cdae9541b', '81119cdd00d27529bfc7412f6e0eb201', 'c37a83f4aaa3e18e3b8a905289ffd7ba', '08717b2f9a5cc8db38bf3ea1a147efd2', '54ddfa7f78a6169608d033c7a4ea6bd8', '0f0a39b185224f08d2493c814b6b706c'], ['df128a954c8794e041fe2cf56462aeda', '02cda4e930de0ac0950b47f3cd8a661e', '0222efc2930039fb3a0c778cc3e2402b', 'a0f490944d4e21f28f8d7098c83b6cc8', 'f15f81b1362da0e67d529414b59b6c30', 'f27fcd820b6eb0c71865f5c6f96e2b41', '5c2516930520fba3c734c77b108882b2', '2945f6960cff8e5fd3e86c27558bacac', '4a33ff2e02374858dc88b3a73fb6e2c8', '74bcdd2821987e6f20362426b44885d1', '0663f73a0c86b038e7f2a8d199c9408f', 'd23efb45b80011f6ac69075a6a474883', 'f7882420c8f6322f06f113134fd27e01', '402467141555383a9dd642a1ed5c8c45', '103f152f9c11b7ee952193be66fd1ffb', '139a6d8d5b0e5f903690509e907b0da0', '614365d699a3fb97636229381b17d1d8', '1a29efb2bdab6dc0ed08c56f66710f8d', 'f1ef7e4e0ea825650a6d6d0e9f636452', '3742292511972efc8248f057748315f2', '85cf417a267d2d467d52843f209221ff', '71238e5650dcea27ad0b3c0f85cdd22b', '2d8fb16d74fdd6c00174a9fa3e75f9a1', 'f9433d70cd3c3a1e19c09aedf143f1fa', 'ea6207e9f5f7c75c2f3e6c64c62ce8a2', '361f7b865d3fcbffaed56c6b13ca04f3', '2788e5f7500269da47a972f823e3ba4c', '5354689dfddec1b20bf032301ab433ee', '9102062869f243716251c72e9ea8b46b', 'f6b2ddff5a54ac9167fafbba0d80a651', '0876468ca3b252ae8d02406ed825bbca', '6444ff819285a23fe4eabd429bd45ec4', 'cf45809bfdf6d8bff8f212b29d52e190', 'df580331d2ce535e201713cd1d5ab5b5', 'f89a1d5833bb59f0bc25a9224494ddec', '23a76d32443c8d721325e51da1a8b37c', '9ec23f596d475476f26878a06e936f8a'], ['1cd05ea6619a54b9e631f4ca6474b241', '1c3d20fd96b6e702c8900e7b02bcc424', 'fc377b569cce8a886e52be63291182a7', 'fd05729dfdfe681e24082405136dbfc0', '681fee85575f36fdb9d25230f6a5a413', '6e44c63af5433291079a67d3e8704848', '1b7be0d320845872ea7f9cf55cc31259', '01db9b3df073c2fae40c4bd5e5212c39', '0f04a0ba608fb72523144680f3d208ed', '74107a96f7f825d0e8587a43ccf4c7aa', 'fa80a2f25faacf39f8cab79bd49ea6ee', 'e6acb771f8f8f1e2a1eebdbb0ecbdb21', '5907094692997131b274c777c5ed8187', 'e53b3745f70a2e2bece7bc6dfc8e31e2', '021658ac4990b7985a764adcd167807b', '2bce14e247fbfd7117db9b65ab2e9d75', '407e6bf694fc0f895fca32eca00ea9dc', '92022b353b33f2527b92c7b7fc22a651', 'f56d1fc0d036c72f9c3cf9ba2e6f924d', '12c8eab175f975ce0c1b7607cb695e49', '0dbdaacec7a1835a12e54f84fa0b256f', '5aa4db32e0f15b73bd80f9a4861a60db', '5d9453417fc9a9fc7205fb46511b24be', 'e82300e1c9df5fe892f19060e69c4f83', 'f65da9fdf905c61df87673006e6af189', '0cce87a7d3b6018162128754dc2f4bc6', '8cec83f021abd5753eeb90a6ae024586', 'afee640bdd29fe77aa10236811c2e0bb', '4a6cb0fb31aa50b74e12e2510dbd1a4e', 'c574adde09ed422515f7a6088acfd286', '1fe41aefbf9b8fbdd6bf94ce8de69a89', '57da4e5e569f93b7d2266e01d6c4724f', 'd0660cfa9eb93bdc082db5977ce40029', '87eceef4945ff5a56de793eedbdf8c67', 'c06866093ff1b9126f57063c26d38af7', '44d53c71fe41b20608b3006e359ea2f3', '5c7563b07536ad60a4dbe5ee418fe32d'], ['fc24b74e733320c11f8225f61686e5e5', 'd4f6968eaea3a02f7b939f528e1fa6b2', 'f09cfa9e8f6ed107d903e43ce5b820a0', '4ad951c5f432bc411eac61d0ca48b035', '06fdbb3ad38219ea9de4ede86505409a', '4f919c6b0a42cc22836eb8bb9e6dbdae', 'd852fb8a411dd32d933b0627cce80454', '1331f662e6623bd28a9fae0431774206', '4125088fefb7f4358762df248a3271bb', 'bc1bef98e5998e93ed6939e39c115c5a', '3205a5529c84e7051c2b6d37f23d150e', '37bf72693b461085a913a99fb4c79063', 'cb31f1e6b9c850e433f8cd5dffbf035a', '2fe1fc7f06f90b72cf17d39fe40c615f', 'af6b9fbaefcce7eb610458821d10a8ed', '7d5c4a6df16ec0386ce2b3428b9f390f', 'e1abd2ca6b94a6a78a35e86b497dc118', 'add72b0c0ffb7d43cd4d1d437c4fa6be', 'f141df37765e1e3c1ff85f3638b6a4a6', '0b1e7a0fbd9b56495dc6221a0a02bb5f', 'e7f32463bb4da7ea1633478d078a9f5d', 'f0e6eb3695b75f332aa911b4a941f3a8', 'c6037d27b0dedb6c9c44215a5ea29bec', 'bed6db812344506b95e9458ce9e93b99', 'bcca61bda550d45cccce16797399f6aa', 'cc84f4a5d4a2ed76b9124e1091346c2d', '115b4d62317c9224146fec8b1b9ab30c', 'e03ba9c0471fbc7665cc4d3be19d38fc', '49b9fc8eac88dda90fca5529f1a16382', '27b49dbd01232df8a3324852b7ebdc7a', '83c8b80ed0a34977720df46c5b34c8f1', '907aa7bae34246c46a89d853eeb4787c', 'd5103934450017cee6a5395b8b5d32f3', 'b57e0e2d31ef8ab936fe776bd6251d0f', '98e745965e4e4f69dd37b87ecd155936', '80cc084719e531d177cc8b60f8513808', '988d46a9bc992b8e5c37f26c4ffbfcf1'], ['ffa41e76c880a1e7fa027c98941b4e09', '5ff417fed48ac0a35b752712d2c27402', '975b6a4d10c86c0fd6e1ad5c746021d8', 'ed17f54c7242fc56b721c37e369cd992', '8580ee738533de897b107710d735bbb4', '7465a35fd755938861a5e9e58a1995dc', '5b6cb95b93ed899b2ddc03482349c5a7', '9daa225764b9c981df550f3c663172c6', 'f7b22c7b28c7014a04773c270f3d60bd', '9ad3da374679e78330327789c01f189d', '4f64706e88a22233f44334f0dcfb7ef0', 'c40783baa44076991ead577caadfd3ac', '31c2de90e21cde35fb6674884c28380a', 'a381f83c5cec7408a26c2927b7b8bab5', 'bf8c6f95130197f62614d24a8645873e', '3206bf787b842de20911a5f0d46b195e', '46b93d61727bc64a7080abecab6108c1', '170293406de42dec469db91ebf9a1ff1', 'd062e75630bb126174cd4a52e0f78246', '62de99c43418286d57949b9d89139004', 'df4bbcb1ca2b788afc632f4dc5e8e15d', '18c4217e003b0e2b2ace2a4da640ffa7', '82ad6c1c14bfc60701863ec82ec0a6a5', 'c7bbccdecb238bbecf8a659b161d05ca', 'b95a4db8cd9fdf50e14fbba4c5546e8a', '6b004168472cee8def4437378fc7d2fb', '2b3e7470c7f3e1182e433083daa4ea75', '269f47ffa66d1d75bb9952517af16739', '715715af0a7549d10ab8a236ec113821', '546d232232a6b9d4144b636d7b6a90d8', '1a2576c1e85d2be2dd578ac828edaac6', '1c3ea563f0e12aa0355ff83f245e8929', '63fe77980b6f5b1014f003c29fdd2f57', '851ea6c220956a2560a31bfe106ba943', '4d4fecf76e01c3460c4d33928ef3174c', '0f61b81237867bb46c2bc1a68d57d9c7', '54ff588cc528c9e7f66dacd5aff2afde'], ['b08c9f761c2473bef74319f0859ef3d7', '02be62ddf5caa4856113ddee8facdfb0', 'c486fc9030818b1c358e51d203696ad1', '279aa50af25caf91c062c7bcdb012c5c', '17f326578f3a4e63e6ca80a3ccdaaf53', '6cef9a3cd964309ddd07990757f13091', '16c7458d88d6ac5831da9a82b9af4e23', '17980cf2c8f0bc34c7bacb840e07daa9', '38930c38d52280f8d9ae1a5d3c433ab4', '53cf6dde1ac0e50db8dac73026959aae', '6b88ac524453585353a267649a18266f', 'b3a33db53a080965f23a2ac5ea03e330', '9099f68afad3837e184a078154a67b06', '35927222b60ce759282de2bdde3137d5', '6530382ee7833091b84a6865192fcc32', 'f6f71960f993ff3d4d151483fd3bd0a5', 'b6659f75230b8352df7cd218f1354ad2', '7e58fcf5a7d4690c1abfbc6f140abf33', '02901572857873b82d9790b13bab79c4', 'da1cdecdb3aebf446f798e3908a91854', '96204cc9f6dbccb9a51ae9640dfcd56d', '1686a196a04f7cbb66b93208a91a3616', '3e8fc48b0f47a954e0c9e959ccfd7f9a', 'fd49e21f2b26f2c4a16dc775a31f35d1', '25ada4d1d0b2acf37a6b616019221b96', '6bfcf5333e9a8e6459fa564d3273aa14', '5eecba39a46cd8bd2df945b00101d77f', '835757cc25537796a117cde153b26923', '37efda46c98a982e0581dcba17def742', 'f72eb45108dca6d8beda128d263842c7', '13b5e2bb147f5c2ef17af22705ecd8c2', 'ee4a231668003de4b8b9164d66cea673', '7acaae612f03dfe305a2ab9349331c51', 'd3cf4a28c038404f03d9c4503cdece2c', 'd13754c339651b59979863d6da2abe87', '557123a9f957c61cdd937e225040b505', 'aeb07fe0c23866c2ca1a13570ddc33e3'], ['64b5878700643bb01dbff2c88c47fb33', '98384919a3814e2d33d2b11a294b7638', '7364230485e7d3458604c8237ae092f4', '4aee58dd72364f7dd2171dd70d4c5234', '7ba0c7cd9c228a7009f96055c49019d5', '6e2488b67bedf536c0e9e359169d0a6c', 'f2a108d53ffc864329627f85ff1509ea', '50bdee4a9f1fd85b2824fc977c3322b5', '45ef35fd358459783a9403e93a5e0c10', 'b699ab6983c65db3ea32a159c91e0c3c', 'b63d5067f0707d4e6abe04abcd828485', '9ac6b9bc5699efb290da3aaf11fecf53', 'f32042518da4fc7eff2bec552aa7e3b5', 'f449bf08d242d0b00e0f953eba3a83ce', '3755679e500167b114da63924353de02', 'cb1c34f44766572412cbe0045554ef2e', '19a631c25fef0b47b5194bd94fc16932', '4d8748039ee6a0acbb3b40d70c3cc318', '18be9064da7828cee01ea362e2b58e7d', '1519562600f80be888574c9d0b22f03f', '1d2584993bd87a0f305aaa1d72925f99', 'fd78af26cab61809ba342aae54b4adc9', 'aa8c4f8f52c49d5e76e1083f4c13845d', '7b65f7b8af10aed7945dff64d6b8e131', '836f46009510a2f302cc8584b00d1252', 'c011b93ac2ba789c9f4a0e117efda39b', '9d3061582c6237c4168fe5ca3026a9b6', '409bbb784aace28beeeeee6df8dcb2ed', '4da7f78f1dcabc33dddebdf68eb64da2', '6d413bb2ba3ad3a16317630e552cff01', 'b06d26e83049ad7924b12d8482a8be02', '5d0c3ef18dd606b219e7a61a2bd579d0', 'd1fc3501363a9d36e3efee90ecc38d96', 'b37b4f0962bcccd74eb3824d5401cccd', '99b3714588b31487afb8254e799245ab', '5a42a920926936189866a07dd9b2c46e', '8e630a8df75ba888ef31132342a14468'], ['327b457659d95838b24f4b43e47d6d9d', 'dd78dc76f6f46f0f53a27e7239d97858', '5574ad0ece2697c93414b37849d3f1ac', 'be71d0a03b3b7f02a48a7952bb60dc31', 'd015c7199beb97529bae8436becd7279', '2c1f0ee97fb8b00733157c5e8de3d2a5', '93bf3078b1822a12263e79aa4db0abaa', 'e8d7c9cad65fcae8df15774a1d99679f', '0e16a10051676f2ab072ae4e556c183b', '1311a2a14717ebf296cdbcd3083f06e9', '5a4f334cf0bb0883ef7f177d1b8116d5', '0cb5ccf9b2f2d9ad0c479bdf2dc6ff0b', 'd8034a9f430cf79cd1a3a46befb19f0b', 'a49fe5add1e15bbaebb4c943d0b1b5d9', '78bb9f5584076f0c9dc409ef4f0c32ce', 'd5d0b23a3cab9b0cd47ebae054e08052', '6dc578f2fbf2c1893b8b6347fc1e7e4e', 'b26696e99407a226ca0e50b665d588a2', '2efabcfcea6b07095a8bb29ea0202038', 'a0788084482cc93841c744ba23a56c4d', '73263a4f5478bcc595a8f7c9986d9d50', '746b613f8292ced40db55eda9d3d01fe', '1a81ed09bb317146a69e16675cd9c850', 'a165b1498314cce7908cd27dab07119c', '525743c175035f7b142c41d4789b8db5', '1b1239e0f8cd30e0cff9220119c9728c', '47ccc50de9bfd350abd263476906f8f3', 'f0bd396f68b25a6feaae4f3f952c4f17', '04e604f6f7a42ff7e8c5cd2a574b11d8', 'bbb226ea6547d60b35387ed2fd90e389', '343394342c694cf3a88eb571f7ca1863', 'd516c861390d2fddf58f2dcf20a2831b', 'f0d7805f8d0998d6e17bf49de93e94ee', '394c064cb3e2d1e66df846ece8ecadf8', '38be5e33f08a467eb6f9f0dc1d7a1966', '99d87cd118a7207103c0852b92e8822f', 'd80d6672b55f1ad16a4a464dea7094fb'], ['ef3c32578059671ee31302127e646446', '0dabaeb1354c4d8037804b4b67bbe371', '0f468436cbf4e6c52403488d417a3e01', '73fa43b0a064a20468d77b67d6765906', 'ea56da1c3b36799d38c65f816af3c602', '9900076aec79e5b128a7bdd1326770c5', '92c6fd13e82e132e9066045ea93591a5', 'e55c3986e2194c9ee3449baa864c02a9', 'bd35bab46b19e8cab41fac73887076a5', 'af55ef35c653eb3b9d1caa10c236f7de', '889a2d21ea0b3f5e68a58bef51151911', '59ca442753a2509ecf35dad6aa176ae3', '19d27ad7d7bd6f08c380d7f8a26811cb', '474dd1afd02035de2b29d905f1d98751', '63d5fd1c207ddc6334b47b88e78aa61d', 'ae275315079f57b2d2dd58637e0f857b', '7d63a04d465d92793e84640b1f809c67', 'faee0e512448c9ccae6c9b87f991c781', '9c56b88b51910fc8e90bf7f9792c57f5', '218825d7a6dfccb03af67e32b9e29985', '0010dc91c68eeed2193ab9ba235b191d', 'd39a02e7e8368638beae3041c6c9006f', '1af66520a6de9f2aceffb9cbb64c1038', '684970d4ee2313fbe11fdd751a2c178b', '5bf557799c2799ad680c2d19b44e1daa', '78ced0e18a48106c7f5fa2af9ec2ec3c', 'b0fb9b374f42bdd3cc05eb6c5112a69f', '0173a1f3ffb58b3c53a45b632593f023', '0ff6504b5c73a87ec230154045b024be', '3ddbac771102ad87ddb8ff49f66cd2a7', '3567354253addb11cdb7a0a8bcfa8882', '279ed6909f6fcec7ab1c4529da8d429b', 'c95ba05af4dc80dd8212dce4e39e608a', '1b1b2d5925b4f21b5d2aacee2a6bcec9', 'b6ae3423edda8b3e990cb67da9e5d0e9', 'beb8a762b997871550e67e4abb18d599', 'd3ab98f02c890e09d9340812fe9f6300'], ['9f29c81ed405ab9356dd0ba901f84af2', '49d0be100b974d9fef99e677490f414e', '5c8ae68ce239f879052626311dfabe62', '4ea5b1f39fbc3459b0878f2c27aaf439', '3b4a565e5c53c3bdb73fc4c9b7686325', '83238e399a33195b5a5ad1fd43dd4afe', '2eb94963cf5e7aff5e573ffa5986be7c', '4c577966e8213fe16256f66ba5755c83', 'b740466954dd5307f1178f8228f22aa2', '9781740de211b4aa3f6fda5ca896ff3d', '2c1d039060c9d9bac61bdbebb57d8df9', 'd6d02fa99b707263fbe20b989032439d', '0429dfc4789d98605f55cf03c28c5d29', '12c4775733e762cea9063544bb98279c', 'd7ecb8432dcc46b876fbfae266dd6c2d', 'f8c7ed7c84a61470e5198dc6d2e927b3', '2ba3e0d36b3e7cacb255cb132d6524e7', 'f8dedd02cc1c2ef1b1268ec5e248a082', '293c0acc4d2a794e4f1c6e368a0fbe54', 'c060f6eed437c77fb80e10947bcc80e2', '397382a127c4bb070b291fa157d40061', '70afb0040bcd72595218743b9b2dc38a', 'b18608172b2c97cd3c8d3b1e98f907a5', '8ebedb58b3aa096bbef409f5e084a5e5', '7ccf6d03b3a113ff9ff5550578efe84b', '37bedbafe961083b930ec654a9d3ad9e', 'ac64723399e53b980feeeb8dcedac79a', 'f7cbb8d2c4a8a03dfe1b6cf759063ab3', 'f75a4277d9e356eaea3fe4211e9478e2', '7e2b8384116ff18e9339d5875b18ca32', '2e33eb68180832279930a6e1a118a0b2', '9b83141227990304194bca4d532c01bd', '0cfabb06a19de9ffc87bc9e953045595', '4d0f6849fdb21c73c090476bc657e8c5', '1aa76f5ce910f38e0056bee53a34da55', 'aa088baca199d5ed82ed28c0cdac14f7', '2ad1786ad7cba013087c7cba993a996e'], ['aac189e2f0ae4ac799475e54db36d3e7', 'ccfedaceafd4bc7ac990c2bcba3f384f', 'bb8f33d4166a54c085e4538496660a87', '6e7a804b30e2a057a28013b080b8b407', '34b53a68cbd1e0394df285a70bca7883', '6e3f862a43895eca950cc42e1c97e795', 'e7af8ff5456f71ad9076c58efedbc56c', '9ddf83b564beba850ff053a8d42051e0', '12062417446a198e67119300d2e51662', '145c01d6c191dcd4822bbfd2af1d7147', '410fc16b481ae9ea8b8e32b562d2fab7', 'a83c68e36a33f83c265b263563d0d542', '42f93fbdea0aa8cc70e78e9864b58af4', '38e407104c5bb2e29fe1cf9457463417', '387f71498eedfa87a0d0cc717408eef5', 'df2f94918380476e410172bbc4d6ff53', '87e295af5d1782252c7eab537b40a3d3', '6fbc729d99eaaf841c0e223f03de644f', 'bcb39ee7351e7f5ea872b778c0dc039e', '1c199d17dc84c3eab42f82772744333c', 'fd4ca5704bacd1f865b98203c1791833', 'b127bf45845a8f0a6a532fb45a39621a', '379c2f5d4862a9524ee16a615f5a239f', '76219c768879cdc40b72bce23d5c0744', '44bc7b3db9013069d9e3c8ed2e43ae28', '77fb6ed0270d3444757cb2fe89ddd09a', '04789e0b7f7351973bc94c2893d62844', 'cb9d78f4b5d9b0435db2b6785b2ebbd6', '921a24369cc88651e88425b65824f069', 'd00ad96b50ca6b43930d1f7d31fd9e52', '21059d9d4ca464e4a2c2962ca70d0243', 'b54a753ad46ec98e3a04ecfc1c9b3722', 'e32c998a9854c7fa91f0634032ca8501', 'c27fd5a94284ebb84b8f4ab54fd906c8', 'd7f37ac0dea1f2836aaaa07838091f74', 'ffb6c1816fe0ee4ad12de6380cb1aa8c', '46f46c6e4dd547089642d63a9a9a8ad2'], ['1fd853f143cbeaceb83bbaf32fdc60b2', '0ad072d5f34291734c8b62a90c1c5553', '30efa916715b964844a4e3dc7fccf98b', '88758f6d331fa0e1a29d384b30bc9743', '2c0203a210454489a3be125664356808', '1fd2144d400a59de7f5a6c64a59d6ec7', 'cbfa0f2b46d8b8616610ead165644d96', 'cf248c41884db7855f645fee996acb36', 'a93152fd2dfd7cb60e854e7c5e8875d8', '4d2195924fe9051e2b64f26d5c31a8c9', 'a7778c95745ac2beb17be0cd79553c26', '20ee333613547bd7e7cf9ba55951b2dd', 'c838cd27dfe3392c22b00e783b56e9af', 'acda9b3ad5cf078c888c5dc356060ceb', '33052f929e6d9aa1c43e3758db5ca201', 'f617f28d7ecfc0af1cbf5fbf5a9fc10d', '830cda7e01751624a50d58e1a6122564', '927fa994b77bcd5fae8c37ebcb445921', 'e772d04360200f25069f5e118e7e6d84', '74c6189d5b39544ba5b98bf875a57e5f', '9e809dedf8571d294e87c607a07efa92', 'aedd70826eb3c2fd79dc0a6e32bfcdfc', '9515d8cd9ddb93c119a6d14bec9db2c2', '6d5ed62d4b73b20f8f03067506400bad', '8c369dbc61ea4b6b4f7f3cc1cc3cc523', '8bf642c81536dab7015c9c19f0b92d97', '0de5e52bea579a7437a4602feb2d1c3a', '12a1f002c169b041d5e834c0ffb0ef5a', '72f36dc5003beee01ffa1e8199bd43f1', '3d7d728882ef7f408b995c30df165d05', '5f2a05f98131f62c01f266030ad17e5f', 'fc12a11cd6b0849fd57926bf9a204b8c', '38486fcc948af5f8b2d22601491fa2b6', '85849b6d690633d7e91bbe189b9c67f6', 'ada2ae80024c2ae5fe4ded22cd9a2d0a', 'c913a0bee71988156dac5a9a5cd43c46', '692be62fcee9c3b14e1a3504ef60c2cd']]

def hash4(m):
    hash = hashlib.sha256(m)
    return hash[:128]

import sys
import socket
import ast

def connect_server(server_name, port, message):
    server = (server_name, int(port)) #calling int is required when using Sage
    s = socket.create_connection(server)
    s.send(message +'\n')
    response=''
    while True: #data might come in several packets, need to wait for all of it
        data = s.recv(9000)
        if not data: break
        response = response+data
    s.close()
    return response.rstrip('\r\n')

server_address = "lasecpc28.epfl.ch"
server_port = 5555
sciper = "227358"

signature = "0"*24
signature = list(signature)

run_ex4 = False

if (run_ex4):
    for i in range(0, len(M4)):
        msg = "a"*24
        msg = list(msg)
        msg[i] = M4[i]
        output = connect_server(server_address, server_port, sciper + " " + "".join(msg))
        output = ast.literal_eval(output)
        signature[i] = output[i]
else:
    signature = "Not running ex 4"

print "Q4="
print signature

###### Exercise 5
print "-"*5 + " EXERCISE 5 " + "-"*5
P51 = "If you win this "
P52 = "challenge as wel"
P53 = "l, I will retake"
P54 = " the course!C.A."
C51 = "c75a37fc4ccf50880f76eaff93db2aa4"
C52 = "821fb33182826c97112e651efd431c1e"
C53 = "243f028c875dbda4fc3c8799d96a71a8"
C54 = "81e8c671ef4c61be4bb159aa717dcb5e"

'''
This is a standard meet-in-the-middle attack.
'''

def cipher_1(k1, m):
    cipher = ""
    k1_prime = hashlib.sha256(k1).hexdigest()[:32]
    c = aes_encrypt(P51,binascii.a2b_hex(k1_prime))
    c = aes_encrypt(c, k1)
    return binascii.b2a_hex(c)

def cipher_2(k2, m):
    cipher = ""
    k2_prime = hashlib.sha256(k2).hexdigest()[:32]
    d = aes_decrypt(binascii.a2b_hex(C51),binascii.a2b_hex(k2_prime))
    d = aes_decrypt(d, k2)
    return binascii.b2a_hex(d)

keywords = ['kadi', 'kaes', 'kago', 'kaid', 'kaif', 'kail', 'kaim', 'kain', 'kaka', 'kaki', 'kale', 'kali',
'kame', 'kami', 'kana', 'kang', 'kans', 'kant', 'kaon', 'kara', 'kart', 'kata', 'kats', 'kava',
'kaws', 'kayo', 'kays', 'kazi', 'keas', 'keck', 'keds', 'keek', 'keel', 'keen', 'keep', 'kefs',
'kegs', 'keir', 'keks', 'kell', 'kelp', 'kelt', 'kemp', 'keno', 'kens', 'kent', 'kepi', 'keps',
'kept', 'kerb', 'kerf', 'kern', 'kesh', 'keta', 'kets', 'keys', 'khan', 'khat', 'khud', 'kibe',
'kick', 'kids', 'kier', 'kifs', 'kike', 'kill', 'kiln', 'kilo', 'kilp', 'kilt', 'kina', 'kind',
'kine', 'king', 'kink', 'kino', 'kins', 'kipe', 'kipp', 'kips', 'kiri', 'kirk', 'kirn', 'kish',
'kiss', 'kist', 'kite', 'kith', 'kits', 'kiva', 'kiwi', 'knag', 'knap', 'knar', 'knee', 'knew',
'knit', 'knob', 'knop', 'knot', 'know', 'knub', 'knur', 'knut', 'koan', 'koas', 'kobs', 'koel',
'koff', 'kohl', 'kola', 'kolo', 'konk', 'kook', 'koph', 'kora', 'kore', 'koss', 'koto', 'krab',
'kris', 'ksar', 'kudu', 'kuku', 'kuri', 'kuru', 'kuzu', 'kyat', 'kyle', 'kyte']

run_ex5 = False

if not run_ex5:
    print "Not running ex 5"
else:
    dictionary = {}

    import itertools

    combinations = list(itertools.product(keywords, repeat=3))

    k1_recovered = ""
    k2_recovered = ""

    for i in combinations:
        key_candidate = i[0] + ' ' + i[1] + ' ' + i[2] + ' !'
        e = cipher_1(key_candidate, P51)
        dictionary[e] = i

    for i in combinations:
        key_candidate = i[0] + ' ' + i[1] + ' ' + i[2] + ' !'
        e = cipher_2(key_candidate, C51)
        if e in dictionary:
            k1_tmp = dictionary[e]
            k1_recovered = k1_tmp[0] + " " + k1_tmp[1] + " " + k1_tmp[2] + " !"
            k2_tmp = i
            k2_recovered = k2_tmp[0] + " " + k2_tmp[1] + " " + k2_tmp[2] + " !"

    print "k1: "
    print k1_recovered
    print "k2: "
    print k2_recovered
